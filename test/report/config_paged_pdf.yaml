# Unified Report Test Configuration
# This config demonstrates all supported report drivers and formats

system:
  log_folder: "."
  output_folder: "test-reports"

engine:
  engine_uri: "wss://sa-win2k25:4747"
  user_name: "qliksa"
  user_directory: "sa-win2k25"
  auth_mode: "cert"           # Options: cert, jwt, desktop
  server_type: "on_prem"      # Options: on_prem, cloud
  certs_path: "../certs/sa-win2k25"

report:
  # Driver: built_in or sense
  driver: "built_in"

  # Format: xlsx, paged_xlsx, pdf, csv, tsv
  format: "paged_xlsx"

  # Report metadata
  name: "TestReport"
  app_id: "0569bf97-812d-455b-9fce-83c7bb6a018d"    # Consumer Sales.qvf
  bookmark_id: "d3a086a7-633c-4c35-94ff-ec009a602bca"  # Bookmark2

  # Target: objects or sheet
  target: "objects"
  target_ids:
    - "KnASd"    # Object ID to export

  # Output options
  orientation: "landscape"      # For PDF: portrait or landscape
  all_borders: true
  output_selection: true

  # Optional output offset (for PDF/Excel cell positioning)
  output_offset:
    left: 3
    top: 3

  # Custom headers (printed before table data)
  headers:
    - label: "Generated By"
      text: "Report Test Tool"
    - label: "App ID"
      text: "0569bf97-812d-455b-9fce-83c7bb6a018d"

  # Custom footers (printed after table data)
  footers:
    - label: "Report Date"
      text: "=Today()"
    - label: "Disclaimer"
      text: "This report is auto-generated for internal use only."

  # Excel Paging Configuration (only used when format: paged_xlsx)
  excel_paging:
    rows_per_page: 15
    report_title: "Paginated Sales Report"
    total_records_label: "Total Records Found"
    show_column_numbers: true
    show_subtotals: true
    header_groups:
      - name: "Sales Metrics"
        start: 2
        length: 3

  # Excel to PDF Conversion (optional, runs after Excel generation)
  # Uncomment to enable automatic Excel-to-PDF conversion
  excel_to_pdf:
    libreoffice_bin: "libreoffice"   # Path to LibreOffice binary
    max_concurrent: 2                 # Max concurrent conversions
    timeout: 30                       # Timeout in seconds
    profile: ""                       # Optional profile name for worker pool

# -----------------------------------------------------------------------------
# CONFIGURATION EXAMPLES FOR DIFFERENT DRIVERS
# -----------------------------------------------------------------------------

# Example 1: Standard Excel Report (excel)
# format: "xlsx"
# driver: "built_in"

# Example 2: Paginated Excel Report (excel_paging)
# format: "paged_xlsx"
# driver: "built_in"
# excel_paging:
#   rows_per_page: 10
#   report_title: "My Paginated Report"
#   show_column_numbers: true
#   show_subtotals: true
#   all_borders: true

# Example 3: PDF Report (pdf)
# format: "pdf"
# driver: "built_in"
# orientation: "landscape"

# Example 4: Paginated PDF Report (pdf_paging via excel_to_pdf_libre)
# Step 1: Generate paginated Excel
# format: "paged_xlsx"
# excel_paging:
#   rows_per_page: 25
# Step 2: Convert to PDF
# excel_to_pdf:
#   libreoffice_bin: "libreoffice"
#   max_concurrent: 4
#   timeout: 60

# Example 5: Excel to PDF using LibreOffice (excel_to_pdf_libre)
# format: "xlsx"
# excel_to_pdf:
#   libreoffice_bin: "/Applications/LibreOffice.app/Contents/MacOS/soffice"  # macOS
#   max_concurrent: 2
#   timeout: 30

# Example 6: CSV Export
# format: "csv"
# driver: "built_in"

# Example 7: TSV Export
# format: "tsv"
# driver: "built_in"

# Example 8: Multiple Objects in One Report
# target: "objects"
# target_ids:
#   - "KnASd"
#   - "obj2"
#   - "obj3"
